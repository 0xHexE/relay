<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>RelayContainer · Relay</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="`RelayContainer` is a higher-order React component that lets a React component encode its data requirements."/><meta name="docsearch:version" content="v1.6.0"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="RelayContainer · Relay"/><meta property="og:type" content="website"/><meta property="og:url" content="https://relay.dev/"/><meta property="og:description" content="`RelayContainer` is a higher-order React component that lets a React component encode its data requirements."/><meta property="og:image" content="https://relay.dev/img/relay.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://relay.dev/img/relay.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-50', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="/js/redirect.js"></script><script type="text/javascript" src="/js/docsRating.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/en"><h2 class="headerTitle">Relay</h2></a><a href="/en/versions"><h3>v1.6.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/en/v1.6.0/introduction-to-relay" target="_self">Docs</a></li><li class=""><a href="/en/help" target="_self">Help</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/facebook/relay" target="_self">GitHub</a></li><li class=""><a target="_self"></a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebook/relay/edit/master/docs/Classic-APIReference-Container.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">RelayContainer</h1></header><article><div><span><p><code>RelayContainer</code> is a higher-order React component that lets a React component encode its data requirements.</p>
<ul>
<li>Relay ensures that this data is available before the component is rendered.</li>
<li>Relay updates the component whenever the underlying data has changed.</li>
</ul>
<p>Relay containers are created using <code>Relay.createContainer</code>.</p>
<h2><a class="anchor" aria-hidden="true" id="overview"></a><a href="#overview" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overview</h2>
<p><em>Container Specification</em></p>
<ul class="apiIndex">
  <li>
    <a href="#fragments">
      <pre>fragments</pre>
      Declare the component's data requirements using fragments.
    </a>
  </li>
  <li>
    <a href="#initialvariables">
      <pre>initialVariables</pre>
      The initial set of variable values available to this component's fragments.
    </a>
  </li>
  <li>
    <a href="#preparevariables">
      <pre>prepareVariables</pre>
      A method to modify the variables based on the runtime environment or previous variable values.
    </a>
  </li>
  <li>
    <a href="#shouldcomponentupdate">
      <pre>shouldComponentUpdate</pre>
      Optionally override RelayContainer's default implementation of `shouldComponentUpdate`.
    </a>
  </li>
</ul>
<p><em>Properties and Methods</em></p>
<p>These are the methods and properties that the container will provide as <code>this.props.relay</code> in the plain React component.</p>
<ul class="apiIndex">
  <li>
    <a href="#route">
      <pre>route</pre>
    </a>
  </li>
  <li>
    <a href="#pendingvariables">
      <pre>pendingVariables </pre>
    </a>
  </li>
  <li>
    <a href="#variables">
      <pre>variables</pre>
    </a>
  </li>
  <li>
    <a href="#setvariables">
      <pre>setVariables([partialVariables[, onReadyStateChange]])</pre>
    </a>
  </li>
  <li>
    <a href="#forcefetch">
      <pre>forceFetch([partialVariables[, onReadyStateChange]]) </pre>
    </a>
  </li>
  <li>
    <a href="#hasoptimisticupdate">
      <pre>hasOptimisticUpdate(record)</pre>
    </a>
  </li>
  <li>
    <a href="#getpendingtransactions">
      <pre>getPendingTransactions(record) </pre>
    </a>
  </li>
</ul>
<p><em>Static Methods</em></p>
<ul class="apiIndex">
  <li>
    <a href="#getfragment">
      <pre>getFragment(name[, vars])</pre>
      Get a reference to a container fragment for inclusion in a parent fragment.
    </a>
  </li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="container-specification"></a><a href="#container-specification" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Container Specification</h2>
<h3><a class="anchor" aria-hidden="true" id="fragments"></a><a href="#fragments" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>fragments</h3>
<pre><code class="hljs">fragments: RelayQueryFragments&lt;Tk&gt; = {
  [propName: <span class="hljs-built_in">string</span>]: <span class="hljs-function">(<span class="hljs-params">
    variables: {[name: <span class="hljs-built_in">string</span>]: mixed}
  </span>) =&gt;</span> Relay.QL<span class="hljs-string">`fragment on ...`</span>
};
</code></pre>
<p>Containers declare data requirements on <code>fragments</code> using GraphQL fragments.</p>
<p>Only fields specified by these fragments will be populated in <code>this.props</code> when the component is rendered. This ensures that there are no implicit dependencies from a component on its parent component or any child components.</p>
<h4><a class="anchor" aria-hidden="true" id="example"></a><a href="#example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<pre><code class="hljs css language-{8-14}"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StarWarsShip</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  render() {
    <span class="hljs-keyword">return</span> &lt;div&gt;{<span class="hljs-keyword">this</span>.props.ship.name}&lt;/div&gt;;
  }
}

module.exports = <span class="hljs-type">Relay</span>.createContainer(<span class="hljs-type">StarWarsShip</span>, {
  fragments: {
    ship: () =&gt; <span class="hljs-type">Relay</span>.<span class="hljs-type">QL</span>`
      fragment on <span class="hljs-type">Ship</span> {
        name
      }
    `,
  },
});

</code></pre>
<p>In this example, the fields associated with the <code>ship</code> fragment will be made available on <code>this.props.ship</code>.</p>
<p>See also: <a href="guides-containers.html#relay-containers">Containers &gt; Relay Containers</a></p>
<h3><a class="anchor" aria-hidden="true" id="initialvariables"></a><a href="#initialvariables" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>initialVariables</h3>
<pre><code class="hljs">initialVariables: {[<span class="hljs-built_in">name</span>: <span class="hljs-built_in">string</span>]: mixed};
</code></pre>
<p>The initial set of variable values available to this component's fragments.</p>
<h4><a class="anchor" aria-hidden="true" id="example-1"></a><a href="#example-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<pre><code class="hljs css language-{4}"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProfilePicture</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> {...}</span>

<span class="hljs-built_in">module</span>.<span class="hljs-built_in">exports</span> = Relay.createContainer(ProfilePicture, {
  initialVariables: {size: <span class="hljs-number">50</span>},
  fragments: {
    user: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> Relay.QL`<span class="javascript">
      # The variable defined above is available here <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;$size&#x27;</span>.
      # Any variable referenced here is required to have been defined <span class="hljs-keyword">in</span> initialVariables above.
      # An <span class="hljs-string">&#x27;undefined&#x27;</span> variable value will <span class="hljs-keyword">throw</span> an <span class="hljs-string">&#x27;Invariant Violation&#x27;</span> exception.
      # Use <span class="hljs-string">&#x27;null&#x27;</span> to initialize unknown values.
      fragment on User { <span class="hljs-function"><span class="hljs-title">profilePicture</span>(<span class="hljs-params">size: $size</span>)</span> { ... } }
    </span>`,
  },
});
</code></pre>
<p>In this example, <code>profilePicture(size: 50)</code> will be fetched for the intial render.</p>
<h3><a class="anchor" aria-hidden="true" id="preparevariables"></a><a href="#preparevariables" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>prepareVariables</h3>
<pre><code class="hljs">prepareVariables: ?<span class="hljs-function">(<span class="hljs-params">
  prevVariables: {[name: <span class="hljs-built_in">string</span>]: mixed}
</span>) =&gt;</span> {[name: <span class="hljs-built_in">string</span>]: mixed}
</code></pre>
<p>Containers can define a <code>prepareVariables</code> method which provides the opportunity to modify the variables that are available to fragments. The new variables can be generated based on the previous variables (or the <code>initialVariables</code> if no previous ones exist) in addition to the runtime environment.</p>
<p>This method is also called after the partial set of variables from <code>setVariables</code> has been applied. The variables returned are used to populate the fragments.</p>
<h4><a class="anchor" aria-hidden="true" id="example-2"></a><a href="#example-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<pre><code class="hljs css language-{3-9}"><span class="hljs-keyword">module</span>.exports = Relay.createContainer(ProfilePicture, {
  initialVariables: {<span class="hljs-built_in">size</span>: <span class="hljs-number">50</span>},
  prepareVariables: prevVariables =&gt; {
    <span class="hljs-keyword">return</span> {
      ...prevVariables,
      <span class="hljs-comment">// If devicePixelRatio is `2`, the new size will be `100`.</span>
      <span class="hljs-built_in">size</span>: prevVariables.<span class="hljs-built_in">size</span> * window.devicePixelRatio,
    };
  },
  <span class="hljs-comment">// ...</span>
});
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="shouldcomponentupdate"></a><a href="#shouldcomponentupdate" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>shouldComponentUpdate</h3>
<pre><code class="hljs">shouldComponentUpdate: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> boolean;
</code></pre>
<p>RelayContainer implements a conservative default <code>shouldComponentUpdate</code> that returns <code>false</code> if no fragment props have changed and all other props are equal scalar values. This may block updates to components that receive data via context. To ensure an update in this case override the default behavior by specifying a <code>shouldComponentUpdate</code> function.</p>
<h4><a class="anchor" aria-hidden="true" id="example-3"></a><a href="#example-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<pre><code class="hljs css language-{2}"><span class="hljs-built_in">module</span>.<span class="hljs-built_in">exports</span> = Relay.createContainer(ProfilePicture, {
  shouldComponentUpdate: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-literal">true</span>,
  <span class="hljs-regexp">//</span> ...
});
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="properties-and-methods"></a><a href="#properties-and-methods" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Properties and Methods</h2>
<p>The properties and methods listed below can be accessed on <code>this.props.relay</code> from the wrapped React component.</p>
<h3><a class="anchor" aria-hidden="true" id="route"></a><a href="#route" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>route</h3>
<pre><code class="hljs"><span class="hljs-symbol">route:</span> RelayRoute
</code></pre>
<p>Route is useful in providing the context which a component is being rendered in. It includes information about the <code>name</code>, <code>params</code>, and <code>queries</code> of the current route.</p>
<h4><a class="anchor" aria-hidden="true" id="example-4"></a><a href="#example-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<pre><code class="hljs"><span class="hljs-keyword">var</span> <span class="hljs-keyword">name</span> = this.props.relay.route.<span class="hljs-keyword">name</span>;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">name</span> === <span class="hljs-string">&#x27;SuperAwesomeRoute&#x27;</span>) <span class="hljs-comment">{
  // Do something super cool.
}</span>
</code></pre>
<p>See also: <a href="guides-routes.html">Routes</a></p>
<h3><a class="anchor" aria-hidden="true" id="variables"></a><a href="#variables" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>variables</h3>
<pre><code class="hljs">variables: {[<span class="hljs-built_in">name</span>: <span class="hljs-built_in">string</span>]: mixed}
</code></pre>
<p><code>variables</code> contains the set of variables that was used to fetch the current set of props.</p>
<h4><a class="anchor" aria-hidden="true" id="example-5"></a><a href="#example-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<pre><code class="hljs css language-{8}"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProfilePicture</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span> {
    <span class="hljs-keyword">var</span> user = <span class="hljs-built_in">this</span>.props.user;
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Image</span>
          <span class="hljs-attr">uri</span>=<span class="hljs-string">{user.profilePicture.uri}</span>
          <span class="hljs-attr">width</span>=<span class="hljs-string">{this.props.relay.variables.size}</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
    );
  }
}
<span class="hljs-built_in">module</span>.exports = Relay.createContainer(ProfilePicture, {
  <span class="hljs-attr">initialVariables</span>: {<span class="hljs-attr">size</span>: <span class="hljs-number">50</span>},
  <span class="hljs-attr">fragments</span>: {
    <span class="hljs-attr">user</span>: <span class="hljs-function">() =&gt;</span> Relay.QL<span class="hljs-string">`
      fragment on User { profilePicture(size: $size) { ... } }
    `</span>,
  },
});
</code></pre>
<p>In this example, the <code>width</code> of the rendered image will always correspond to the <code>$size</code> variable used to fetch the current version of <code>profilePicture.uri</code>.</p>
<blockquote>
<p>Note</p>
<p>Never mutate <code>this.props.relay.variables</code> directly as it will not trigger data to be fetched properly. Treat <code>this.props.relay.variables</code> as if it were immutable, just like props.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="pendingvariables"></a><a href="#pendingvariables" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>pendingVariables</h3>
<pre><code class="hljs">pendingVariables: ?{[<span class="hljs-built_in">name</span>: <span class="hljs-built_in">string</span>]: mixed}
</code></pre>
<p><code>pendingVariables</code> contains the set of variables that are being used to fetch the new props, i.e. when <code>this.props.relay.setVariables()</code> or <code>this.props.relay.forceFetch()</code> are called and the corresponding request is in flight.</p>
<p>If no request is in flight pendingVariables is <code>null</code>.</p>
<h4><a class="anchor" aria-hidden="true" id="example-6"></a><a href="#example-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<pre><code class="hljs css language-{12}"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProfilePicture</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  requestRandomPictureSize = <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> randIntMin = <span class="hljs-number">10</span>;
    <span class="hljs-keyword">const</span> randIntMax = <span class="hljs-number">200</span>;
    <span class="hljs-keyword">const</span> size = (<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * (randIntMax - randIntMin + <span class="hljs-number">1</span>)) + randIntMin);
    <span class="hljs-built_in">this</span>.props.relay.setVariables({size});
  }

  <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span> {
    <span class="hljs-keyword">const</span> {relay, user} = <span class="hljs-built_in">this</span>.props;
    <span class="hljs-keyword">const</span> {pendingVariables} = relay;
    <span class="hljs-keyword">if</span> (pendingVariables &amp;&amp; <span class="hljs-string">&#x27;size&#x27;</span> <span class="hljs-keyword">in</span> pendingVariables) {
      <span class="hljs-comment">// Profile picture with new size is loading</span>
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">LoadingSpinner</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
      )
    }

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Image</span>
          <span class="hljs-attr">uri</span>=<span class="hljs-string">{user.profilePicture.uri}</span>
          <span class="hljs-attr">width</span>=<span class="hljs-string">{relay.variables.size}</span>
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">{this.requestRandomPictureSize}</span>&gt;</span>
          Request random picture size
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
    );
  }
}
<span class="hljs-built_in">module</span>.exports = Relay.createContainer(ProfilePicture, {
  <span class="hljs-attr">initialVariables</span>: {<span class="hljs-attr">size</span>: <span class="hljs-number">50</span>},
  <span class="hljs-attr">fragments</span>: {
    <span class="hljs-attr">user</span>: <span class="hljs-function">() =&gt;</span> Relay.QL<span class="hljs-string">`
      fragment on User { profilePicture(size: $size) { ... } }
    `</span>,
  },
});
</code></pre>
<p>In this example, whenever a picture with a new size is being loaded a spinner is displayed instead of the picture.</p>
<h3><a class="anchor" aria-hidden="true" id="setvariables"></a><a href="#setvariables" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>setVariables</h3>
<pre><code class="hljs">setVariables([partialVariables: <span class="hljs-built_in">Object</span>, [onReadyStateChange: <span class="hljs-built_in">Function</span>]]): <span class="hljs-keyword">void</span>
</code></pre>
<p>Components can change their data requirements by using <code>setVariables</code> to request an update to the current set of <code>variables</code>.</p>
<p><code>this.props.relay.setVariables</code> can be called to update a subset or all of the variables at the same time. In return, Relay will use the new variables to attempt to fulfill the new fragment. This may involve sending a request to the server if data is not already available on the client.</p>
<p>An optional <code>onReadyStateChange</code> callback can be supplied to respond to the events involved with the data fulfillment.</p>
<h4><a class="anchor" aria-hidden="true" id="example-7"></a><a href="#example-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<pre><code class="hljs css language-{12-15}"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Feed</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span> {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        {this.props.viewer.feed.edges.map(
          edge =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">Story</span> <span class="hljs-attr">story</span>=<span class="hljs-string">{edge.node}</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{edge.node.id}</span> /&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }
  <span class="hljs-function"><span class="hljs-title">_handleScrollLoad</span>(<span class="hljs-params"></span>)</span> {
    <span class="hljs-comment">// Increments the number of stories being rendered by 10.</span>
    <span class="hljs-built_in">this</span>.props.relay.setVariables({
      <span class="hljs-attr">count</span>: <span class="hljs-built_in">this</span>.props.relay.variables.count + <span class="hljs-number">10</span>
    });
  }
}
<span class="hljs-built_in">module</span>.exports = Relay.createContainer(Feed, {
  <span class="hljs-attr">initialVariables</span>: {<span class="hljs-attr">count</span>: <span class="hljs-number">10</span>},
  <span class="hljs-attr">fragments</span>: {
    <span class="hljs-attr">viewer</span>: <span class="hljs-function">() =&gt;</span> Relay.QL<span class="hljs-string">`
      fragment on Viewer {
        feed(first: $count) {
          edges {
            node {
              id,
              <span class="hljs-subst">${Story.getFragment(<span class="hljs-string">&#x27;story&#x27;</span>)}</span>,
            },
          },
        },
      }
    `</span>,
  },
});
</code></pre>
<blockquote>
<p>Note</p>
<p><code>setVariables</code> does not immediately mutate <code>variables</code>, but creates a  pending state transition. <code>variables</code> will continue returning the previous values until <code>this.props</code> has been populated with data that fulfills the new variable values.</p>
</blockquote>
<p>See also: <a href="guides-containers.html#requesting-different-data">Containers &gt; Requesting Different Data</a>, <a href="guides-ready-state.html">Ready State</a></p>
<h3><a class="anchor" aria-hidden="true" id="forcefetch"></a><a href="#forcefetch" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>forceFetch</h3>
<pre><code class="hljs">forceFetch([partialVariables: <span class="hljs-built_in">Object</span>, [onReadyStateChange: <span class="hljs-built_in">Function</span>]]): <span class="hljs-keyword">void</span>
</code></pre>
<p><code>forceFetch</code> is similar to <code>setVariables</code> because it is also used to change the data requirements by altering <code>variables</code>.</p>
<p>The two methods differ in that instead of sending a query that includes only fields missing from the client, <code>forceFetch</code> sends a request to refetch each and every fragment. This ensures that the props for the component are freshly fetched from the server.</p>
<p>An optional <code>onReadyStateChange</code> callback can be supplied to respond to the events involved with the data fulfillment.</p>
<blockquote>
<p>Note</p>
<p><code>forceFetch</code> can be called with an empty set of partial variables, meaning it can trigger a refresh of the currently rendered set of data.</p>
</blockquote>
<p>See also: <a href="guides-ready-state.html">Ready State</a></p>
<h3><a class="anchor" aria-hidden="true" id="hasoptimisticupdate"></a><a href="#hasoptimisticupdate" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>hasOptimisticUpdate</h3>
<pre><code class="hljs">hasOptimisticUpdate(<span class="hljs-type">record</span>: <span class="hljs-keyword">Object</span>): <span class="hljs-type">boolean</span>
</code></pre>
<p>Calling <code>hasOptimisticUpdate</code> with a record from <code>this.props</code> will return whether that given record is affected by an optimistic mutation. It allows the component to render local optimistic changes differently from data that has successfully synchronized with the server.</p>
<h4><a class="anchor" aria-hidden="true" id="example-8"></a><a href="#example-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<pre><code class="hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Feed</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  render() {
    <span class="hljs-keyword">var</span> edges = <span class="hljs-keyword">this</span>.props.viewer.feed.edges;
    <span class="hljs-keyword">return</span> (
      &lt;div&gt;
        {edges.map(edge =&gt; {
          <span class="hljs-keyword">var</span> node = edge.node;
          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.props.relay.hasOptimisticUpdate(node)) {
            <span class="hljs-comment">// Render pending story that has not been stored</span>
            <span class="hljs-comment">// on the server using a diffrent component.</span>
            <span class="hljs-keyword">return</span> (
              &lt;<span class="hljs-type">PendingStory</span>
                key={edge.node.id}
                story={edge.node}
              /&gt;
            );
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> (
              &lt;<span class="hljs-type">Story</span>
                key={edge.node.id}
                story={edge.node}
              /&gt;
            );
          }
        })}
      &lt;/div&gt;
    );
  }
}

module.exports = <span class="hljs-type">Relay</span>.createContainer(<span class="hljs-type">Feed</span>, {
  initialVariables: {count: <span class="hljs-number">10</span>},
  fragments: {
    viewer: () =&gt; <span class="hljs-type">Relay</span>.<span class="hljs-type">QL</span>`
      fragment on <span class="hljs-type">Viewer</span> {
        feed(first: $count) {
          edges {
            node {
              id,
              ${<span class="hljs-type">Story</span>.getFragment(<span class="hljs-symbol">&#x27;stor</span>y&#x27;)},
              ${<span class="hljs-type">PendingStory</span>.getFragment(<span class="hljs-symbol">&#x27;stor</span>y&#x27;)}
            }
          }
        }
      }
    `,
  },
});

</code></pre>
<p>See also: <a href="guides-mutations.html#optimistic-updates">Mutations &gt; Optimistic Updates</a></p>
<h3><a class="anchor" aria-hidden="true" id="getpendingtransactions"></a><a href="#getpendingtransactions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>getPendingTransactions</h3>
<pre><code class="hljs">getPendingTransactions(<span class="hljs-keyword">record</span>: <span class="hljs-keyword">Object</span>): ?<span class="hljs-keyword">Array</span>&lt;RelayMutationTransaction&gt;
</code></pre>
<p>Components can inspect pending mutations on any record (i.e. data made available in props with a corresponding fragment). Calling <code>getPendingTransactions</code> with a record will return a list of the pending mutation transactions that affect that particular record.</p>
<p>Each <code>RelayMutationTransaction</code> has methods to check the status of the mutation and provide ways to rollback or resend the mutation as needed.</p>
<h4><a class="anchor" aria-hidden="true" id="example-9"></a><a href="#example-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<pre><code class="hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Story</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span> {
    <span class="hljs-keyword">var</span> story = <span class="hljs-built_in">this</span>.props.story;
    <span class="hljs-keyword">var</span> transactions = <span class="hljs-built_in">this</span>.props.relay.getPendingTransactions(story);
    <span class="hljs-comment">// For this example, assume there is only one transaction.</span>
    <span class="hljs-keyword">var</span> transaction = transactions ? transactions[<span class="hljs-number">0</span>] : <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (transaction) {
      <span class="hljs-comment">// Display an error message with a retry link if a mutation failed.</span>
      <span class="hljs-keyword">if</span> (transaction.getStatus() === <span class="hljs-string">&#x27;COMMIT_FAILED&#x27;</span>) {
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>
            This story failed to post.
            <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{transaction.recommit}</span>&gt;</span>Try Again.<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>
        );
      }
    }
    <span class="hljs-comment">// Render story normally.</span>
  }
}

<span class="hljs-built_in">module</span>.exports = Relay.createContainer(ProfilePicture, {
  <span class="hljs-attr">fragments</span>: {
    <span class="hljs-attr">story</span>: <span class="hljs-function">() =&gt;</span> Relay.QL<span class="hljs-string">`
      fragment on story {
        # ...
      }
    `</span>,
  },
});
</code></pre>
<p><code>RelayMutationTransaction.getStatus</code> can return one of the following strings:</p>
<ul>
<li><code>UNCOMMITTED</code> — Transaction hasn't yet been sent to the server. Transaction can be committed or rolled back.</li>
<li><code>COMMIT_QUEUED</code> —  Transaction was committed but another transaction with the same collision key is pending, so the transaction has been queued to send to the server.</li>
<li><code>COLLISION_COMMIT_FAILED</code> — Transaction was queued for commit but another transaction with the same collision key failed. All transactions in the collision queue, including this one, have been failed. Transaction can be recommitted or rolled back.</li>
<li><code>COMMITTING</code> — Transaction is waiting for the server to respond.</li>
<li><code>COMMIT_FAILED</code> — Transaction was sent to the server for comitting but failed.</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="static-methods"></a><a href="#static-methods" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Static Methods</h2>
<h3><a class="anchor" aria-hidden="true" id="getfragment"></a><a href="#getfragment" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>getFragment</h3>
<pre><code class="hljs"><span class="hljs-selector-tag">getFragment</span>(
  <span class="hljs-attribute">fragmentName</span>: string,
  variables?: {<span class="hljs-selector-attr">[name: string]</span>: <span class="hljs-selector-tag">mixed</span>}
): <span class="hljs-selector-tag">RelayFragmentReference</span>
</code></pre>
<p>Gets a reference to a child container's fragment for inclusion in a parent fragment.</p>
<h4><a class="anchor" aria-hidden="true" id="example-10"></a><a href="#example-10" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<p>Fragment composition is achieved via ES6 template string interpolation and <code>getFragment</code>:</p>
<pre><code class="hljs css language-{6}">// <span class="hljs-selector-tag">Parent</span><span class="hljs-selector-class">.js</span>
<span class="hljs-selector-tag">Relay</span><span class="hljs-selector-class">.createContainer</span>(<span class="hljs-selector-tag">Parent</span>, {
  <span class="hljs-attribute">fragments</span>: {
    parentFragment: () =&gt; Relay.QL`
      fragment on Foo {
        id
        ${Child.<span class="hljs-built_in">getFragment</span>(<span class="hljs-string">&#x27;childFragment&#x27;</span>)}
      }
    `,
  }
});
// <span class="hljs-selector-tag">Child</span><span class="hljs-selector-class">.js</span>
<span class="hljs-selector-tag">Relay</span><span class="hljs-selector-class">.createContainer</span>(<span class="hljs-selector-tag">Child</span>, {
  <span class="hljs-attribute">initialVariables</span>: {
    size: <span class="hljs-number">64</span>,
  },
  <span class="hljs-selector-tag">fragments</span>: {
    <span class="hljs-attribute">childFragment</span>: () =&gt; Relay.QL`
      fragment on Foo {
        <span class="hljs-built_in">photo</span>(size: $size) { uri }
      }
    `,
  }
});
</code></pre>
<p>In this example, whenever <code>Parent</code> is fetched, <code>Child</code>'s fragment will also be fetched. When rendering, <code>&lt;Parent&gt;</code> will only have access to the <code>props.foo.id</code> field;  data from the child fragment will be <a href="http://facebook.github.io/relay/docs/thinking-in-relay.html#data-masking"><em>masked</em></a>. By default, <code>childFragment</code> will use its corresponding initial variables. Relay will fetch <code>photo(size: 64)</code>. When <code>&lt;Child&gt;</code> is rendered it will also make the initial variables available as <code>props.relay.variables = {size: 64}</code>.</p>
<h4><a class="anchor" aria-hidden="true" id="overriding-fragment-variables"></a><a href="#overriding-fragment-variables" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overriding Fragment Variables</h4>
<p>Sometimes a parent needs to override the default variables of a child component. Imagine that we want to render <code>Child</code> above with a photo size of 128 instead of the default 64. To do this, we have to ensure that both the fragment <em>and</em> the container know about the custom variable. To set a custom variable in the <em>query</em>, use the second argument to <code>getFragment</code>:</p>
<pre><code class="hljs css language-{6}">// <span class="hljs-selector-tag">Parent</span><span class="hljs-selector-class">.js</span>
<span class="hljs-selector-tag">Relay</span><span class="hljs-selector-class">.createContainer</span>(<span class="hljs-selector-tag">Parent</span>, {
  <span class="hljs-attribute">fragments</span>: {
    parentFragment: () =&gt; Relay.QL`
      fragment on Foo {
        id
        ${Child.<span class="hljs-built_in">getFragment</span>(<span class="hljs-string">&#x27;childFragment&#x27;</span>, {size: <span class="hljs-number">128</span>})}
      }
    `,
  }
});
</code></pre>
<p>Now Relay will fetch the photo with size 128 - but the <code>Child</code> container won't magically know about this variable. We have to tell it by passing the variable value as a prop:</p>
<pre><code class="hljs css language-{4}"><span class="hljs-keyword">const</span> Parent = <span class="hljs-function">(<span class="hljs-params">props</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Child</span>
      <span class="hljs-attr">childFragment</span>=<span class="hljs-string">{props.parentFragment}</span>
      <span class="hljs-attr">size</span>=<span class="hljs-string">{128}</span>
    /&gt;</span></span>;
  );
}
</code></pre>
<p>Now Relay will both fetch the larger photo size <em>and</em> <code>Child</code> will know to render it.</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 11/9/2017 by Jan Kassens</em></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#overview">Overview</a></li><li><a href="#container-specification">Container Specification</a><ul class="toc-headings"><li><a href="#fragments">fragments</a></li><li><a href="#initialvariables">initialVariables</a></li><li><a href="#preparevariables">prepareVariables</a></li><li><a href="#shouldcomponentupdate">shouldComponentUpdate</a></li></ul></li><li><a href="#properties-and-methods">Properties and Methods</a><ul class="toc-headings"><li><a href="#route">route</a></li><li><a href="#variables">variables</a></li><li><a href="#pendingvariables">pendingVariables</a></li><li><a href="#setvariables">setVariables</a></li><li><a href="#forcefetch">forceFetch</a></li><li><a href="#hasoptimisticupdate">hasOptimisticUpdate</a></li><li><a href="#getpendingtransactions">getPendingTransactions</a></li></ul></li><li><a href="#static-methods">Static Methods</a><ul class="toc-headings"><li><a href="#getfragment">getFragment</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><div class="left-column"><div class="docsRating" id="docsRating">Is this page useful?<svg class="i_thumbsup" alt="Like" id="docsRating-like" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 81.13 89.76"><path d="M22.9 6a18.57 18.57 0 002.67 8.4 25.72 25.72 0 008.65 7.66c3.86 2 8.67 7.13 13.51 11 3.86 3.11 8.57 7.11 11.54 8.45s13.59.26 14.64 1.17c1.88 1.63 1.55 9-.11 15.25-1.61 5.86-5.96 10.55-6.48 16.86-.4 4.83-2.7 4.88-10.93 4.88h-1.35c-3.82 0-8.24 2.93-12.92 3.62a68 68 0 01-9.73.5c-3.57 0-7.86-.08-13.25-.08-3.56 0-4.71-1.83-4.71-4.48h8.42a3.51 3.51 0 000-7H12.28a2.89 2.89 0 01-2.88-2.88 1.91 1.91 0 01.77-1.78h16.46a3.51 3.51 0 000-7H12.29c-3.21 0-4.84-1.83-4.84-4a6.41 6.41 0 011.17-3.78h19.06a3.5 3.5 0 100-7H9.75A3.51 3.51 0 016 42.27a3.45 3.45 0 013.75-3.48h13.11c5.61 0 7.71-3 5.71-5.52-4.43-4.74-10.84-12.62-11-18.71-.15-6.51 2.6-7.83 5.36-8.56m0-6a6.18 6.18 0 00-1.53.2c-6.69 1.77-10 6.65-9.82 14.5.08 5.09 2.99 11.18 8.52 18.09H9.74a9.52 9.52 0 00-6.23 16.9 12.52 12.52 0 00-2.07 6.84 9.64 9.64 0 003.65 7.7 7.85 7.85 0 00-1.7 5.13 8.9 8.9 0 005.3 8.13 6 6 0 00-.26 1.76c0 6.37 4.2 10.48 10.71 10.48h13.25a73.75 73.75 0 0010.6-.56 35.89 35.89 0 007.58-2.18 17.83 17.83 0 014.48-1.34h1.35c4.69 0 7.79 0 10.5-1 3.85-1.44 6-4.59 6.41-9.38.2-2.46 1.42-4.85 2.84-7.62a41.3 41.3 0 003.42-8.13 48 48 0 001.59-10.79c.1-5.13-1-8.48-3.35-10.55-2.16-1.87-4.64-1.87-9.6-1.88a46.86 46.86 0 01-6.64-.29c-1.92-.94-5.72-4-8.51-6.3l-1.58-1.28c-1.6-1.3-3.27-2.79-4.87-4.23-3.33-3-6.47-5.79-9.61-7.45a20.2 20.2 0 01-6.43-5.53 12.44 12.44 0 01-1.72-5.36 6 6 0 00-6-5.86z"></path></svg><svg class="i_thumbsdown" alt="Dislike" id="docsRating-dislike" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 81.13 89.76"><path d="M22.9 6a18.57 18.57 0 002.67 8.4 25.72 25.72 0 008.65 7.66c3.86 2 8.67 7.13 13.51 11 3.86 3.11 8.57 7.11 11.54 8.45s13.59.26 14.64 1.17c1.88 1.63 1.55 9-.11 15.25-1.61 5.86-5.96 10.55-6.48 16.86-.4 4.83-2.7 4.88-10.93 4.88h-1.35c-3.82 0-8.24 2.93-12.92 3.62a68 68 0 01-9.73.5c-3.57 0-7.86-.08-13.25-.08-3.56 0-4.71-1.83-4.71-4.48h8.42a3.51 3.51 0 000-7H12.28a2.89 2.89 0 01-2.88-2.88 1.91 1.91 0 01.77-1.78h16.46a3.51 3.51 0 000-7H12.29c-3.21 0-4.84-1.83-4.84-4a6.41 6.41 0 011.17-3.78h19.06a3.5 3.5 0 100-7H9.75A3.51 3.51 0 016 42.27a3.45 3.45 0 013.75-3.48h13.11c5.61 0 7.71-3 5.71-5.52-4.43-4.74-10.84-12.62-11-18.71-.15-6.51 2.6-7.83 5.36-8.56m0-6a6.18 6.18 0 00-1.53.2c-6.69 1.77-10 6.65-9.82 14.5.08 5.09 2.99 11.18 8.52 18.09H9.74a9.52 9.52 0 00-6.23 16.9 12.52 12.52 0 00-2.07 6.84 9.64 9.64 0 003.65 7.7 7.85 7.85 0 00-1.7 5.13 8.9 8.9 0 005.3 8.13 6 6 0 00-.26 1.76c0 6.37 4.2 10.48 10.71 10.48h13.25a73.75 73.75 0 0010.6-.56 35.89 35.89 0 007.58-2.18 17.83 17.83 0 014.48-1.34h1.35c4.69 0 7.79 0 10.5-1 3.85-1.44 6-4.59 6.41-9.38.2-2.46 1.42-4.85 2.84-7.62a41.3 41.3 0 003.42-8.13 48 48 0 001.59-10.79c.1-5.13-1-8.48-3.35-10.55-2.16-1.87-4.64-1.87-9.6-1.88a46.86 46.86 0 01-6.64-.29c-1.92-.94-5.72-4-8.51-6.3l-1.58-1.28c-1.6-1.3-3.27-2.79-4.87-4.23-3.33-3-6.47-5.79-9.61-7.45a20.2 20.2 0 01-6.43-5.53 12.44 12.44 0 01-1.72-5.36 6 6 0 00-6-5.86z"></path></svg></div><div><a href="/" class="nav-home"><img src="/img/relay.svg" alt="Relay" width="66" height="58"/></a><div class="links-column"><h5>Docs</h5><a href="/docs/en/introduction-to-relay.html">Introduction</a></div></div></div><div><h5>Community</h5><a href="/en/users.html">User Showcase</a></div><div><h5>More</h5><a href="https://github.com/facebook/relay">GitHub</a><a href="https://opensource.facebook.com/legal/terms">Terms of Use</a><a href="https://opensource.facebook.com/legal/privacy">Privacy Policy</a><a href="https://opensource.facebook.com/legal/data-policy/">Data Policy</a><a href="https://opensource.facebook.com/legal/cookie-policy/">Cookie Policy</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2021 Facebook Inc.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '3d7d5825d50ea36bca0e6ad06c926f06',
                indexName: 'relay',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["version:v1.6.0"]}
              });
            </script></body></html>